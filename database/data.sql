-- Script d'insertion des données de test
-- Mot de passe par défaut pour tous les utilisateurs : "password123"

-- Supprimer les données existantes (dans l'ordre inverse des dépendances)
DELETE FROM notifications;
DELETE FROM task_history;
DELETE FROM tasks;
DELETE FROM project_members;
DELETE FROM projects;
DELETE FROM users;

-- Insertion d'utilisateurs de test
INSERT INTO users (id, user_name, email, password) VALUES
('10000000-0000-0000-0000-000000000001', 'john.doe', 'john.doe@example.com', '$2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy'),
('10000000-0000-0000-0000-000000000002', 'jane.smith', 'jane.smith@example.com', '$2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy'),
('10000000-0000-0000-0000-000000000003', 'bob.johnson', 'bob.johnson@example.com', '$2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy'),
('10000000-0000-0000-0000-000000000004', 'alice.brown', 'alice.brown@example.com', '$2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy'),
('10000000-0000-0000-0000-000000000005', 'charlie.wilson', 'charlie.wilson@example.com', '$2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy');

-- Insertion de projets de test avec dates de début
INSERT INTO projects (id, name, description, starting_date) VALUES
('20000000-0000-0000-0000-000000000001', 'Application Web E-commerce', 'Développement d''une application web e-commerce avec Angular et Spring Boot', CURRENT_DATE - INTERVAL '20 days'),
('20000000-0000-0000-0000-000000000002', 'Système de Gestion de Projets', 'Application de gestion de projets avec suivi des tâches', CURRENT_DATE + INTERVAL '5 days'),
('20000000-0000-0000-0000-000000000003', 'API REST pour Mobile', 'Développement d''une API REST pour application mobile', CURRENT_DATE - INTERVAL '15 days'),
('20000000-0000-0000-0000-000000000004', 'Site Vitrine Entreprise', 'Création d''un site vitrine pour présenter l''entreprise', CURRENT_DATE - INTERVAL '40 days'),
('20000000-0000-0000-0000-000000000005', 'Application de Gestion RH', 'Système de gestion des ressources humaines', CURRENT_DATE - INTERVAL '5 days');

-- Insertion de membres dans les projets avec rôles
INSERT INTO project_members (project_id, user_id, role) VALUES
('20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000002', 'ADMIN'),
('20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000003', 'MEMBER'),
('20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000004', 'MEMBER'),
('20000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000001', 'MEMBER'),
('20000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000003', 'MEMBER'),
('20000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000004', 'OBSERVER'),
('20000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000005', 'MEMBER'),
('20000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000002', 'ADMIN'),
('20000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000004', 'MEMBER'),
('20000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000001', 'MEMBER'),
('20000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000002', 'MEMBER'),
('20000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000001', 'ADMIN'),
('20000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000002', 'MEMBER');

-- Insertion de tâches de test avec dates de fin pour certaines
INSERT INTO tasks (id, project_member_project_id, project_member_user_id, name, description, status, priority, due_date, end_date) VALUES
('30000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000002', 'Conception de la base de données', 'Créer le schéma de la base de données avec toutes les tables nécessaires', 'DONE', 'HIGH', CURRENT_DATE - INTERVAL '15 days', CURRENT_DATE - INTERVAL '12 days'),
('30000000-0000-0000-0000-000000000002', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000002', 'Développement du backend Spring Boot', 'Implémenter les contrôleurs et services pour les utilisateurs et projets', 'IN_PROGRESS', 'HIGH', CURRENT_DATE + INTERVAL '5 days', NULL),
('30000000-0000-0000-0000-000000000003', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000003', 'Création des composants Angular', 'Développer les composants pour la gestion des utilisateurs', 'TODO', 'MEDIUM', CURRENT_DATE + INTERVAL '10 days', NULL),
('30000000-0000-0000-0000-000000000004', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000002', 'Tests unitaires backend', 'Écrire les tests unitaires pour les services et contrôleurs', 'TODO', 'MEDIUM', CURRENT_DATE + INTERVAL '7 days', NULL),
('30000000-0000-0000-0000-000000000005', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000003', 'Tests unitaires frontend', 'Écrire les tests unitaires pour les composants Angular', 'TODO', 'MEDIUM', CURRENT_DATE + INTERVAL '12 days', NULL),
('30000000-0000-0000-0000-000000000006', '20000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000001', 'Analyse des besoins', 'Analyser et documenter les besoins du projet', 'DONE', 'HIGH', CURRENT_DATE - INTERVAL '8 days', CURRENT_DATE - INTERVAL '5 days'),
('30000000-0000-0000-0000-000000000007', '20000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000001', 'Architecture technique', 'Définir l''architecture technique de l''application', 'IN_PROGRESS', 'HIGH', CURRENT_DATE + INTERVAL '2 days', NULL),
('30000000-0000-0000-0000-000000000008', '20000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000002', 'Développement API REST', 'Créer les endpoints REST pour les ressources principales', 'IN_PROGRESS', 'HIGH', CURRENT_DATE + INTERVAL '5 days', NULL),
('30000000-0000-0000-0000-000000000009', '20000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000004', 'Documentation API', 'Documenter l''API avec Swagger/OpenAPI', 'TODO', 'MEDIUM', CURRENT_DATE + INTERVAL '8 days', NULL),
('30000000-0000-0000-0000-000000000010', '20000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000001', 'Design de la page d''accueil', 'Créer le design de la page d''accueil du site', 'DONE', 'LOW', CURRENT_DATE - INTERVAL '35 days', CURRENT_DATE - INTERVAL '30 days'),
('30000000-0000-0000-0000-000000000011', '20000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000002', 'Intégration du contenu', 'Intégrer le contenu fourni par le client', 'DONE', 'MEDIUM', CURRENT_DATE - INTERVAL '30 days', CURRENT_DATE - INTERVAL '5 days'),
('30000000-0000-0000-0000-000000000012', '20000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000001', 'Développement du module de recrutement', 'Créer le module de gestion des candidatures', 'IN_PROGRESS', 'HIGH', CURRENT_DATE + INTERVAL '10 days', NULL),
('30000000-0000-0000-0000-000000000013', '20000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000002', 'Interface de gestion des employés', 'Développer l''interface pour gérer les informations des employés', 'TODO', 'MEDIUM', CURRENT_DATE + INTERVAL '15 days', NULL);

-- Insertion d'historique des modifications de tâches
INSERT INTO task_history (id, task_id, project_member_project_id, project_member_user_id, field_name, old_value, new_value, modified_at) VALUES
('40000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000002', 'status', 'TODO', 'IN_PROGRESS', CURRENT_TIMESTAMP - INTERVAL '16 days'),
('40000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000002', 'status', 'IN_PROGRESS', 'DONE', CURRENT_TIMESTAMP - INTERVAL '12 days'),
('40000000-0000-0000-0000-000000000003', '30000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000002', 'endDate', NULL, (CURRENT_DATE - INTERVAL '12 days')::text, CURRENT_TIMESTAMP - INTERVAL '12 days'),
('40000000-0000-0000-0000-000000000004', '30000000-0000-0000-0000-000000000002', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000002', 'status', 'TODO', 'IN_PROGRESS', CURRENT_TIMESTAMP - INTERVAL '13 days'),
('40000000-0000-0000-0000-000000000005', '30000000-0000-0000-0000-000000000003', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000003', 'priority', 'LOW', 'MEDIUM', CURRENT_TIMESTAMP - INTERVAL '10 days'),
('40000000-0000-0000-0000-000000000006', '30000000-0000-0000-0000-000000000006', '20000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000001', 'status', 'IN_PROGRESS', 'DONE', CURRENT_TIMESTAMP - INTERVAL '5 days'),
('40000000-0000-0000-0000-000000000007', '30000000-0000-0000-0000-000000000006', '20000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000001', 'endDate', NULL, (CURRENT_DATE - INTERVAL '5 days')::text, CURRENT_TIMESTAMP - INTERVAL '5 days'),
('40000000-0000-0000-0000-000000000008', '30000000-0000-0000-0000-000000000007', '20000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000001', 'status', 'TODO', 'IN_PROGRESS', CURRENT_TIMESTAMP - INTERVAL '6 days'),
('40000000-0000-0000-0000-000000000009', '30000000-0000-0000-0000-000000000008', '20000000-0000-0000-0000-000000000003', '10000000-0000-0000-0000-000000000002', 'status', 'TODO', 'IN_PROGRESS', CURRENT_TIMESTAMP - INTERVAL '10 days'),
('40000000-0000-0000-0000-000000000010', '30000000-0000-0000-0000-000000000010', '20000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000001', 'status', 'IN_PROGRESS', 'DONE', CURRENT_TIMESTAMP - INTERVAL '30 days'),
('40000000-0000-0000-0000-000000000011', '30000000-0000-0000-0000-000000000011', '20000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000002', 'status', 'IN_PROGRESS', 'DONE', CURRENT_TIMESTAMP - INTERVAL '5 days'),
('40000000-0000-0000-0000-000000000012', '30000000-0000-0000-0000-000000000011', '20000000-0000-0000-0000-000000000004', '10000000-0000-0000-0000-000000000002', 'endDate', NULL, (CURRENT_DATE - INTERVAL '5 days')::text, CURRENT_TIMESTAMP - INTERVAL '5 days'),
('40000000-0000-0000-0000-000000000013', '30000000-0000-0000-0000-000000000012', '20000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000001', 'status', 'TODO', 'IN_PROGRESS', CURRENT_TIMESTAMP - INTERVAL '1 days');

-- Insertion de notifications de test
INSERT INTO notifications (id, project_member_project_id, project_member_user_id, task_id, message, created_at, is_read) VALUES
('50000000-0000-0000-0000-000000000001', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000001', 'La tâche "Conception de la base de données" a été complétée', CURRENT_TIMESTAMP - INTERVAL '12 days', true),
('50000000-0000-0000-0000-000000000002', '20000000-0000-0000-0000-000000000001', '10000000-0000-0000-0000-000000000002', '30000000-0000-0000-0000-000000000002', 'La tâche "Développement du backend Spring Boot" est en cours', CURRENT_TIMESTAMP - INTERVAL '13 days', true),
('50000000-0000-0000-0000-000000000003', '20000000-0000-0000-0000-000000000002', '10000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000006', 'La tâche "Analyse des besoins" a été complétée', CURRENT_TIMESTAMP - INTERVAL '5 days', false),
('50000000-0000-0000-0000-000000000004', '20000000-0000-0000-0000-000000000005', '10000000-0000-0000-0000-000000000001', '30000000-0000-0000-0000-000000000012', 'La tâche "Développement du module de recrutement" a été mise à jour', CURRENT_TIMESTAMP - INTERVAL '1 days', false);
